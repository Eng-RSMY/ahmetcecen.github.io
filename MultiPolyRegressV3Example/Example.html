
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Example For MultiPolyRegress</title><meta name="generator" content="MATLAB 8.2"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2014-07-25"><meta name="DC.source" content="Example.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Example For MultiPolyRegress</h1><!--introduction--><p>X is your Data matrix. 500 data point with 5 dimensions. Another way to look at this is 500 samples of 5 independent variables. Y is your observation vector 500 by 1. You want to find a good polynomial fit of columns of X to Y. Lets say you decided fit a 2nd degree polynomial to all 5 independent variables. And you are for the moment, interested in fitting the standard polynomial basis without further meddling with the terms.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">How to Use the Inputs</a></li><li><a href="#2">Plain</a></li><li><a href="#3">Normalization - Range</a></li><li><a href="#4">Figure</a></li><li><a href="#5">Legend</a></li><li><a href="#6">PV</a></li><li><a href="#7">How to Use the Outputs</a></li><li><a href="#8">PowerMatrix</a></li><li><a href="#9">Scores</a></li><li><a href="#10">Cofficients</a></li><li><a href="#11">Legend</a></li><li><a href="#12">yhat</a></li><li><a href="#13">Residuals</a></li><li><a href="#14">Goodness of Fit Measures</a></li></ul></div><h2>How to Use the Inputs<a name="1"></a></h2><h2>Plain<a name="2"></a></h2><pre class="codeinput">load <span class="string">Example.mat</span>
reg=MultiPolyRegress(X,Y,2) <span class="comment">% Gives you your fit.</span>
</pre><pre class="codeoutput">
reg = 

         FitParameters: '-----------------'
           PowerMatrix: [21x5 double]
                Scores: [500x21 double]
          Coefficients: [21x1 double]
                Legend: 'No Legend'
                  yhat: [500x1 double]
             Residuals: [500x1 double]
         GoodnessOfFit: '-----------------'
               RSquare: 0.9392
                   MAE: 0.0334
                MAESTD: 0.0481
         Normalization: '1-to-1 (Default)'
    LOOCVGoodnessOfFit: '-----------------'
             CVRSquare: 0.9280
                 CVMAE: 0.0366
              CVMAESTD: 0.0590
       CVNormalization: '1-to-1 (Default)'

</pre><h2>Normalization - Range<a name="3"></a></h2><p>Different error definition ONLY in the calculation of MAE, MAESTD, CVMAE and CVMAESTD. Does not effect the fit.</p><pre class="codeinput">load <span class="string">Example.mat</span>
reg=MultiPolyRegress(X,Y,2,<span class="string">'range'</span>)
</pre><pre class="codeoutput">
reg = 

         FitParameters: '-----------------'
           PowerMatrix: [21x5 double]
                Scores: [500x21 double]
          Coefficients: [21x1 double]
                Legend: 'No Legend'
                  yhat: [500x1 double]
             Residuals: [500x1 double]
         GoodnessOfFit: '-----------------'
               RSquare: 0.9392
                   MAE: 0.0293
                MAESTD: 0.0313
         Normalization: 'Range'
    LOOCVGoodnessOfFit: '-----------------'
             CVRSquare: 0.9280
                 CVMAE: 0.0313
              CVMAESTD: 0.0346
       CVNormalization: 'Range'

</pre><h2>Figure<a name="4"></a></h2><p>You would like to see a scatter plot of your fit.</p><pre class="codeinput">reg=MultiPolyRegress(X,Y,2,<span class="string">'figure'</span>);
</pre><img vspace="5" hspace="5" src="Example_01.png" alt=""> <h2>Legend<a name="5"></a></h2><p>You would like to see the actual formula of the fit,</p><pre class="codeinput">reg=MultiPolyRegress(X,Y,2,<span class="string">'legend'</span>);
PolynomialFormula=vpa([reg.Coefficients reg.Legend],5)
</pre><pre class="codeoutput"> 
PolynomialFormula =
 
[    0.0052679,    x5]
[    0.0073888,    x4]
[ -0.000087941, x4*x5]
[     0.016723,    x3]
[  -0.00097694, x3*x5]
[  0.000083902, x3*x4]
[     0.015417,    x2]
[   -0.0025415, x2*x5]
[     0.002392, x2*x4]
[  -0.00018939, x2*x3]
[    -0.028576,    x1]
[  -0.00045571, x1*x5]
[  -0.00037732, x1*x4]
[  -0.00010521, x1*x3]
[  -0.00047654, x1*x2]
[       4.0108,   1.0]
[ -0.000049811,  x1^2]
[  -0.00026949,  x2^2]
[   0.00014575,  x3^2]
[ -0.000065765,  x4^2]
[     0.011599,  x5^2]
 
</pre><h2>PV<a name="6"></a></h2><p>You would like to limit the observed powers of certain terms in your polynomial. For example, you do not want the 1st and 4th Independent Variables (x1 and x4) to have second order terms (x1^2 or x4^2). Notice you have to explicitly write how high each term can go in powers, so I would also state I am fine with (x2 x3 and x5) having 2nd order terms.</p><pre class="codeinput">reg=MultiPolyRegress(X,Y,2,[1 2 2 1 2],<span class="string">'legend'</span>);
PolynomialFormula=vpa([reg.Coefficients reg.Legend],5)
</pre><pre class="codeoutput"> 
PolynomialFormula =
 
[   0.0022642,    x5]
[   0.0058919,    x4]
[ -0.00049119, x4*x5]
[     0.01644,    x3]
[ -0.00098813, x3*x5]
[ 0.000076129, x3*x4]
[    0.014969,    x2]
[  -0.0023337, x2*x5]
[   0.0028077, x2*x4]
[ -0.00012646, x2*x3]
[   -0.027613,    x1]
[ -0.00036617, x1*x5]
[ -0.00043459, x1*x4]
[ -0.00011518, x1*x3]
[  -0.0009348, x1*x2]
[      3.9964,   1.0]
[   0.0004941,  x2^2]
[  0.00014775,  x3^2]
[    0.010017,  x5^2]
 
</pre><h2>How to Use the Outputs<a name="7"></a></h2><pre class="codeinput">reg=MultiPolyRegress(X,Y,2);
</pre><h2>PowerMatrix<a name="8"></a></h2><p>You have a new data point you would like to evaluate using the computed fit. Lets assume for the sake of argument that the 250th row of X is in fact a new data point.</p><p>Unless you have a stake in deeply understanding this code, don't try to make sense of the NewScores matrix, or what follows. I sometimes have to stare at it for a couple minutes to figure it out myself. I am happy discuss this in detail upon specific request.</p><p>You have to repeat this procedure for every new data point. It might be time saving to write a function that does this automatically, however I never needed this functionality, so I wouldn't count on me writing that.</p><pre class="codeinput">NewDataPoint=X(250,:);
NewScores=repmat(NewDataPoint,[length(reg.PowerMatrix) 1]).^reg.PowerMatrix;
EvalScores=ones(length(reg.PowerMatrix),1);
<span class="keyword">for</span> ii=1:size(reg.PowerMatrix,2)
    EvalScores=EvalScores.*NewScores(:,ii);
<span class="keyword">end</span>
yhatNew=reg.Coefficients'*EvalScores <span class="comment">% The estimate for the new data point.</span>
</pre><pre class="codeoutput">
yhatNew =

    5.2877

</pre><h2>Scores<a name="9"></a></h2><p>Unless you have a stake in deeply understanding this code, don't try to make sense of the Scores matrix, chances are you won't ever need to use it.</p><h2>Cofficients<a name="10"></a></h2><p>This was shown earlier at the input examples.</p><h2>Legend<a name="11"></a></h2><p>This was shown earlier at the input examples.</p><h2>yhat<a name="12"></a></h2><p>This is the vector of estimates using your new fit. The scatter plot you see when you use the 'figure' option is generated using scatter(yhat,y).</p><h2>Residuals<a name="13"></a></h2><p>This is defined as y-yhat. Can be used for a residual plot to see if ordinary least squares assumptions hold true.</p><h2>Goodness of Fit Measures<a name="14"></a></h2><p>These are useful not only in assesing the accuracy of your fit, but also comparing different candidates. For example, lets see how different powers compare for the same fit for the above dataset. I personally would like to use CVMAE as my comparative error measure, since it is more sensitive to overfitting.</p><p>It turns out, the second degree polynomial is the best option. One way to interpret this number is saying the fit makes in average a 3.66% error with respect to the original Y when estimating.</p><pre class="codeinput"><span class="keyword">for</span> ii=1:5
    reg=MultiPolyRegress(X,Y,ii);
    CVMAE(ii)=reg.CVMAE;
<span class="keyword">end</span>
CVMAE
</pre><pre class="codeoutput">
CVMAE =

    0.0383    0.0366    0.0416    0.1255    3.7904

</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2013b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Example For MultiPolyRegress
% X is your Data matrix. 500 data point with 5 dimensions. Another way to
% look at this is 500 samples of 5 independent variables. Y is your
% observation vector 500 by 1. You want to find a good polynomial fit of
% columns of X to Y. Lets say you decided fit a 2nd degree polynomial to
% all 5 independent variables. And you are for the moment, interested in fitting the
% standard polynomial basis without further meddling with the terms.
%% How to Use the Inputs
%% Plain
load Example.mat
reg=MultiPolyRegress(X,Y,2) % Gives you your fit.
%% Normalization - Range
% Different error definition ONLY in the calculation of MAE, MAESTD, CVMAE
% and CVMAESTD. Does not effect the fit.
load Example.mat
reg=MultiPolyRegress(X,Y,2,'range')
%% Figure
% You would like to see a scatter plot of your fit.
reg=MultiPolyRegress(X,Y,2,'figure');
%% Legend
% You would like to see the actual formula of the fit,
reg=MultiPolyRegress(X,Y,2,'legend');
PolynomialFormula=vpa([reg.Coefficients reg.Legend],5)
%% PV 
% You would like to limit the observed powers of certain terms in your
% polynomial. For example, you do not want the 1st and 4th Independent
% Variables (x1 and x4) to have second order terms (x1^2 or x4^2). Notice
% you have to explicitly write how high each term can go in powers, so I
% would also state I am fine with (x2 x3 and x5) having 2nd order terms. 

reg=MultiPolyRegress(X,Y,2,[1 2 2 1 2],'legend'); 
PolynomialFormula=vpa([reg.Coefficients reg.Legend],5)
%% How to Use the Outputs
reg=MultiPolyRegress(X,Y,2);
%% PowerMatrix
% You have a new data point you would like to evaluate using the computed
% fit. Lets assume for the sake of argument that the 250th row of X is in
% fact a new data point.
%
% Unless you have a stake in deeply understanding this code, don't try to
% make sense of the NewScores matrix, or what follows. I sometimes have to
% stare at it for a couple minutes to figure it out myself. I am happy
% discuss this in detail upon specific request.
%
% You have to repeat this procedure for every new data point. It might be
% time saving to write a function that does this automatically, however I
% never needed this functionality, so I wouldn't count on me writing that.
NewDataPoint=X(250,:);
NewScores=repmat(NewDataPoint,[length(reg.PowerMatrix) 1]).^reg.PowerMatrix;
EvalScores=ones(length(reg.PowerMatrix),1);
for ii=1:size(reg.PowerMatrix,2)
    EvalScores=EvalScores.*NewScores(:,ii);
end
yhatNew=reg.Coefficients'*EvalScores % The estimate for the new data point.

%% Scores
% Unless you have a stake in deeply understanding this code, don't try to
% make sense of the Scores matrix, chances are you won't ever need to use
% it.
%% Cofficients
% This was shown earlier at the input examples.
%% Legend
% This was shown earlier at the input examples.
%% yhat
% This is the vector of estimates using your new fit. The scatter plot you
% see when you use the 'figure' option is generated using scatter(yhat,y).
%% Residuals
% This is defined as y-yhat. Can be used for a residual plot to see if
% ordinary least squares assumptions hold true.
%% Goodness of Fit Measures
% These are useful not only in assesing the accuracy of your fit, but also
% comparing different candidates. For example, lets see how different
% powers compare for the same fit for the above dataset. I personally would
% like to use CVMAE as my comparative error measure, since it is more
% sensitive to overfitting.
%
% It turns out, the second degree polynomial is the best option. One way to
% interpret this number is saying the fit makes in average a 3.66% error with
% respect to the original Y when estimating.
for ii=1:5
    reg=MultiPolyRegress(X,Y,ii);
    CVMAE(ii)=reg.CVMAE;
end
CVMAE
 



##### SOURCE END #####
--></body></html>